---
title: 如何理解闭包
date: 2023-10-01
tags: 
 - 前端
 - JavaScript
categories: 前端
keywords:
 - 闭包
---

# 定义
闭包是一种特殊应用，它是可以使**内部函数**访问**外部函数**的变量和函数，并将这个访问的能力打包带走。即使外部函数已经执行完毕，这些变量和函数依然会存在（*因为在函数内部存在引用，没有被垃圾回收机制回收*）

# 应用
## 数据私有化

**模块模式**： 利用闭包创建一个*数据私有化*的“模块”
```js
function createCounter(){
	let count = 0;
	return function counter(){
		count+=1;
		console.log(count)
	}
}

const counter1 = createCounter();

counter1() // 1
counter1() // 2
```

## 处理回调函数
事件处理器，例如列表中的某个按钮绑定事件。

```js
function createItemClickHandler(productId) {
    // 外部函数：它接收并私有化了 productId

    return function(event) {
        // 内部函数（闭包）：这是真正的事件处理器
        // 它在将来（点击时）才会被调用，但它永远记住了 productId 的值

        console.log(`你点击了商品 ID 为 ${productId} 的按钮。`);
        // 可以在这里执行 API 调用、跳转页面等操作...
    };
}

// ----------------- 使用闭包 -----------------

// 假设我们有商品 A (ID 101) 和 商品 B (ID 202)
const handlerA = createItemClickHandler(101); // 创建一个记住 101 的闭包
const handlerB = createItemClickHandler(202); // 创建一个记住 202 的闭包

// 将这些闭包附加到对应的按钮上 (我们用函数调用来模拟点击)
// buttonA.addEventListener('click', handlerA);
// buttonB.addEventListener('click', handlerB);

// 模拟点击
handlerA(); 
handlerB();
```

- 简易的cache工具